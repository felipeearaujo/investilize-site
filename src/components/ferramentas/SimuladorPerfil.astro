---
// src/components/ferramentas/SimuladorPerfil.astro
---

<div class="tool-page">
    <div class="calculator-container">
        <div class="header-icon">üéØ</div>
        <h2>Simulador de Perfil de Investidor</h2>
        <p class="subtitle">Descubra seu perfil de risco (Suitability)</p>

        <form id="suitability-form">
            <div class="question-group">
                <label for="q1">1. Por quanto tempo voc√™ pretende manter seus investimentos?</label>
                <select id="q1" name="q1">
                    <option value="1">Curto prazo (at√© 2 anos)</option>
                    <option value="2">M√©dio prazo (de 2 a 5 anos)</option>
                    <option value="3">Longo prazo (mais de 5 anos)</option>
                </select>
            </div>

            <div class="question-group">
                <label for="q2">2. Qual √© o seu principal objetivo ao investir?</label>
                <select id="q2" name="q2">
                    <option value="1">Preservar meu patrim√¥nio, com baixo risco.</option>
                    <option value="2">Equilibrar risco e retorno para um crescimento moderado.</option>
                    <option value="3">Maximizar o retorno, mesmo que envolva maiores riscos.</option>
                </select>
            </div>

            <div class="question-group">
                <label for="q3">3. Qual frase descreve melhor sua atitude em rela√ß√£o a investimentos?</label>
                <select id="q3" name="q3">
                    <option value="1">Prefiro seguran√ßa total, mesmo rendendo pouco.</option>
                    <option value="2">Aceito oscila√ß√µes moderadas para tentar ganhar mais.</option>
                    <option value="3">Aceito alta volatilidade em busca de retornos expressivos.</option>
                </select>
            </div>

            <div class="question-group">
                <label for="q4">4. Qual porcentagem da sua renda voc√™ poupa mensalmente?</label>
                <select id="q4" name="q4">
                    <option value="1">Menos de 10%</option>
                    <option value="2">De 10% a 30%</option>
                    <option value="3">Mais de 30%</option>
                </select>
            </div>

            <div class="question-group">
                <label for="q5">5. Se precisasse de dinheiro hoje, de onde tiraria?</label>
                <select id="q5" name="q5">
                    <option value="1">Resgataria meus investimentos (preciso de liquidez imediata).</option>
                    <option value="2">Tenho uma reserva, mas talvez mexesse nos investimentos.</option>
                    <option value="3">Tenho reserva de emerg√™ncia robusta, n√£o mexeria nos investimentos.</option>
                </select>
            </div>

            <div class="question-group">
                <label for="q6">6. Qual seu conhecimento sobre o mercado financeiro?</label>
                <select id="q6" name="q6">
                    <option value="1">B√°sico (Poupan√ßa, CDBs de grandes bancos).</option>
                    <option value="2">Intermedi√°rio (Conhe√ßo FIIs, Tesouro, A√ß√µes).</option>
                    <option value="3">Avan√ßado (Derivativos, Aloca√ß√£o estrat√©gica, Trade).</option>
                </select>
            </div>
        </form>
        
        <button id="calculate-profile-btn">Ver Meu Perfil</button>
        
        <div id="profile-result-container"></div>
    </div>
</div>

<style>
    .tool-page { width: 100%; font-family: sans-serif; }

    .calculator-container {
        background-color: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid #f0f0f0;
        width: 100%;
        max-width: 600px;
        margin: 0 auto;
        box-sizing: border-box;
    }

    .header-icon { font-size: 2rem; margin-bottom: 10px; text-align: center; }
    h2 { color: #1f2937; margin: 0; font-size: 1.8rem; text-align: center; }
    .subtitle { margin-top: 5px; margin-bottom: 30px; color: #6b7280; font-size: 0.95rem; text-align: center; }

    .question-group { 
        margin-bottom: 20px;
        text-align: left; 
    }

    label { 
        display: block; 
        margin-bottom: 8px; 
        font-weight: 600; 
        color: #374151;
        font-size: 0.95rem;
    }

    select { 
        width: 100%; 
        padding: 12px; 
        border: 1px solid #d1d5db; 
        border-radius: 8px; 
        box-sizing: border-box; 
        font-size: 1rem;
        background-color: #f9fafb;
        cursor: pointer;
        transition: border-color 0.2s;
    }

    select:focus {
        border-color: #7c3aed;
        outline: none;
    }

    button { 
        width: 100%; 
        padding: 15px; 
        background-color: #7c3aed; 
        color: white; 
        border: none; 
        border-radius: 8px; 
        font-size: 1.1rem;
        font-weight: bold; 
        cursor: pointer; 
        transition: background-color 0.2s; 
        margin-top: 10px;
    }

    button:hover { 
        background-color: #6d28d9;
    }

    #profile-result-container {
        margin-top: 25px;
        padding: 20px;
        background-color: #f0fdf4; /* Verde claro suave */
        border: 1px solid #bbf7d0;
        border-radius: 8px;
        text-align: left;
        line-height: 1.6;
        display: none; /* Come√ßa escondido */
        animation: fadeIn 0.5s ease-out;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>

<script>
function setupSuitabilityTest() {
    const calculateBtn = document.getElementById('calculate-profile-btn');
    const resultContainer = document.getElementById('profile-result-container');
    const questions = document.querySelectorAll('#suitability-form select');

    if (!calculateBtn || !resultContainer || questions.length === 0) return;

    calculateBtn.addEventListener('click', () => {
        let totalScore = 0;
        
        // TypeScript safe casting
        questions.forEach(q => {
            const select = q as HTMLSelectElement;
            totalScore += parseInt(select.value);
        });

        let profileName = '';
        let profileDescription = '';
        let colorClass = '';

        // L√≥gica de Pontua√ß√£o (6 a 18 pontos)
        if (totalScore <= 9) { 
            profileName = "CONSERVADOR";
            profileDescription = "Sua prioridade √© seguran√ßa. Voc√™ prefere n√£o perder dinheiro a ganhar muito. Investimentos ideais: Tesouro Selic, CDBs de grandes bancos e Fundos de Renda Fixa Simples.";
            colorClass = "#15803d"; // Verde escuro
        } else if (totalScore <= 14) {
            profileName = "MODERADO";
            profileDescription = "Voc√™ aceita correr riscos calculados para superar a infla√ß√£o e a poupan√ßa. Carteira ideal: Renda Fixa (cr√©dito privado), Fundos Multimercado e uma pequena parte em A√ß√µes ou FIIs.";
            colorClass = "#d97706"; // Laranja
        } else { // >= 15
            profileName = "ARROJADO";
            profileDescription = "Voc√™ entende que o mercado oscila e aceita ver seu saldo cair no curto prazo em busca de multiplica√ß√£o de patrim√¥nio no longo prazo. Foco em: A√ß√µes, FIIs, Criptomoedas e Investimentos no Exterior.";
            colorClass = "#b91c1c"; // Vermelho
        }

        resultContainer.innerHTML = `
            <h3 style="margin-top:0; color: ${colorClass}; font-size: 1.5rem;">${profileName}</h3>
            <p style="color: #374151; margin-bottom: 15px;">${profileDescription}</p>
            <div style="background: white; padding: 10px; border-radius: 6px; font-size: 0.85rem; color: #666; border-left: 3px solid #ccc;">
                <strong>Nota:</strong> Este teste √© educativo. Para recomenda√ß√µes oficiais, consulte uma corretora ou analista certificado (CNPI).
            </div>
        `;
        resultContainer.style.display = 'block';
    });
}

document.addEventListener('astro:page-load', setupSuitabilityTest);
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', setupSuitabilityTest);
} else {
    setupSuitabilityTest();
}
</script>